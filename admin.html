<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–ê–¥–º–∏–Ω–∫–∞ ‚Äî –ë–ª–∞–≥–æ–¥–µ–Ω—Ç</title>
<style>
body { font-family: Arial; background:#f5f6f7; padding:20px }
h1,h2 { margin-top:0 }
.section { background:#fff; padding:15px; border-radius:8px; margin-bottom:20px }
input, textarea { width:100%; padding:8px; margin-top:5px }
button { margin-top:10px; padding:8px 20px; cursor:pointer }
.item { border:1px solid #ddd; padding:10px; margin-top:10px }
</style>
</head>
<body>

<h1>–ê–¥–º–∏–Ω–∫–∞ —Å–∞–π—Ç–∞ ¬´–ë–ª–∞–≥–æ–¥–µ–Ω—Ç¬ª</h1>

<div class="section">
<h2>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
<input id="title" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
<input id="phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω">
<input id="address" placeholder="–ê–¥—Ä–µ—Å">
<textarea id="description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ"></textarea>
</div>

<div class="section">
<h2>–£—Å–ª—É–≥–∏</h2>
<div id="services"></div>
<button onclick="addService()">+ –î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É</button>
</div>

<div class="section">
<h2>–¶–µ–Ω—ã</h2>
<div id="prices"></div>
<button onclick="addPrice()">+ –î–æ–±–∞–≤–∏—Ç—å —Ü–µ–Ω—É</button>
</div>

<div class="section">
<h2>–ë–ª–æ–≥</h2>
<div id="blog"></div>
<button onclick="addPost()">+ –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç—å—é</button>
</div>

<button onclick="save()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å—ë</button>
<div id="status"></div>

<script>
const API = "https://long-water-566b.jobwarce.workers.dev/api/site";
let data = { info:{}, services:[], prices:[], blog:[] };

fetch(API).then(r=>r.json()).then(d=>{
 data = d || data;
 document.getElementById('title').value = data.info?.title || "";
 document.getElementById('phone').value = data.info?.phone || "";
 document.getElementById('address').value = data.info?.address || "";
 document.getElementById('description').value = data.info?.description || "";
 render();
});

function render(){
 renderList("services", data.services, ["name","description","price"]);
 renderList("prices", data.prices, ["title","price"]);
 renderList("blog", data.blog, ["title","text","date"]);
}

function renderList(id, arr, fields){
 const box = document.getElementById(id);
 box.innerHTML="";
 arr.forEach((item,i)=>{
  let html='<div class="item">';
  fields.forEach(f=>{
   html+=`<input placeholder="${f}" value="${item[f]||""}" 
    oninput="data.${id}[${i}].${f}=this.value">`;
  });
  html+=`<button onclick="data.${id}.splice(${i},1);render()">–£–¥–∞–ª–∏—Ç—å</button></div>`;
  box.innerHTML+=html;
 });
}

function addService(){ data.services.push({}); render(); }
function addPrice(){ data.prices.push({}); render(); }
function addPost(){ data.blog.push({date:new Date().toISOString().slice(0,10)}); render(); }

function save(){
 data.info={
  title:title.value,
  phone:phone.value,
  address:address.value,
  description:description.value
 };
 fetch(API,{
  method:"POST",
  headers:{ "Content-Type":"application/json" },
  body:JSON.stringify(data)
 }).then(()=>{
  status.innerText="–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ ‚úî";
 });
}
</script>

</body>
</html>